<%#
  Badge Component

  Usage:
    <%= render "shared/badge", text: "새로운" %>
    <%= render "shared/badge", text: "학생", variant: :blue %>
    <%= render "shared/badge", text: "교사", variant: :green %>
    <%= render "shared/badge", text: "관리자", variant: :red %>

  Role badge (automatic color based on role):
    <%= render "shared/badge", role: :student %>
    <%= render "shared/badge", role: :teacher %>
    <%= render "shared/badge", role: :admin %>

  With icon:
    <%= render "shared/badge", text: "완료", variant: :green, icon: "check" %>

  Sizes:
    <%= render "shared/badge", text: "작은", size: :sm %>
    <%= render "shared/badge", text: "기본", size: :md %>
    <%= render "shared/badge", text: "큰", size: :lg %>

  Parameters:
    - text: (String) 배지 텍스트
    - role: (Symbol) 역할 (:student, :teacher, :admin) - 자동 색상 적용
    - variant: (Symbol) :gray, :blue, :green, :red, :yellow, :purple (default: :gray)
    - size: (Symbol) :sm, :md, :lg (default: :md)
    - rounded: (Boolean) 완전히 둥글게 (default: true)
    - icon: (String) 아이콘 이름
    - class: (String) 추가 CSS 클래스
-%>
<%
  text ||= nil
  role ||= nil
  variant ||= :gray
  size ||= :md
  rounded ||= true
  icon ||= nil
  extra_class ||= ""

  # Role을 기반으로 variant와 text 자동 설정
  if role.present?
    role_config = {
      student: { variant: :blue, text: "학생" },
      teacher: { variant: :green, text: "교사" },
      admin: { variant: :red, text: "관리자" }
    }
    config = role_config[role.to_sym] || role_config[:student]
    variant = config[:variant]
    text ||= config[:text]
  end

  text ||= "배지"

  variant_classes = {
    gray: "bg-gray-100 text-gray-800",
    blue: "bg-blue-100 text-blue-800",
    green: "bg-green-100 text-green-800",
    red: "bg-red-100 text-red-800",
    yellow: "bg-yellow-100 text-yellow-800",
    purple: "bg-purple-100 text-purple-800"
  }

  size_classes = {
    sm: "px-2 py-0.5 text-xs",
    md: "px-2.5 py-0.5 text-xs",
    lg: "px-3 py-1 text-sm"
  }

  rounded_class = rounded ? "rounded-full" : "rounded-md"

  badge_classes = [
    "inline-flex items-center font-medium",
    variant_classes[variant],
    size_classes[size],
    rounded_class,
    extra_class
  ].compact.join(" ")
%>

<span class="<%= badge_classes %>">
  <% if icon.present? %>
    <%= render "shared/icons/#{icon}", class: "mr-1 h-3 w-3" rescue nil %>
  <% end %>
  <%= text %>
</span>
