#!/bin/bash -e

# Set HTTP_PORT for Thruster from Railway's PORT environment variable
export HTTP_PORT="${PORT:-80}"

# Always run database preparation in production
if [ "$RAILS_ENV" == "production" ]; then
  echo "Running database migrations..."
  ./bin/rails db:prepare || echo "Database prepare failed, continuing..."
fi

exec "${@}"
